<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio Mosaic Test</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Open Sans', sans-serif;
      background: #111;
      color: #fff;
      overflow-x: hidden;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header / Navigation */
    .site-header {
      padding: 30px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #111;
    }

    .site-logo {
      font-size: 1.5rem;
      font-weight: 300;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: #fff;
      text-decoration: none;
    }

    .site-nav {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    .site-nav a {
      color: rgba(255, 255, 255, 0.6);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 300;
      letter-spacing: 1px;
      transition: color 0.3s ease;
    }

    .site-nav a:hover,
    .site-nav a.active {
      color: #fff;
    }

    /* Dropdown menu */
    .nav-dropdown {
      position: relative;
    }

    .nav-dropdown > a {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .nav-dropdown > a::after {
      content: 'â–¾';
      font-size: 0.7rem;
      opacity: 0.6;
      transition: transform 0.3s ease;
    }

    .nav-dropdown:hover > a::after {
      transform: rotate(180deg);
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      background: #1a1a1a;
      min-width: 150px;
      padding: 10px 0;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s ease;
      border-radius: 4px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      z-index: 100;
    }

    .nav-dropdown:hover .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(5px);
    }

    .dropdown-menu a {
      display: block;
      padding: 10px 20px;
      white-space: nowrap;
    }

    .dropdown-menu a:hover {
      background: rgba(255,255,255,0.05);
    }

    /* Mobile menu toggle */
    .nav-toggle {
      display: none;
      flex-direction: column;
      gap: 5px;
      cursor: pointer;
      padding: 5px;
    }

    .nav-toggle span {
      width: 25px;
      height: 2px;
      background: #fff;
      transition: all 0.3s ease;
    }

    @media (max-width: 768px) {
      .site-header {
        padding: 20px;
      }

      .nav-toggle {
        display: flex;
      }

      .site-nav {
        position: absolute;
        top: 70px;
        left: 0;
        right: 0;
        background: #111;
        flex-direction: column;
        gap: 0;
        padding: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }

      .site-nav.active {
        max-height: 300px;
      }

      .site-nav a {
        display: block;
        padding: 15px 20px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
      }

      .nav-dropdown > a::after {
        display: none;
      }

      .dropdown-menu {
        position: static;
        opacity: 1;
        visibility: visible;
        transform: none;
        background: transparent;
        box-shadow: none;
        padding: 0;
        min-width: 0;
      }

      .dropdown-menu a {
        padding-left: 35px;
        font-size: 0.85rem;
      }
    }

    /* Main content area - centers mosaic vertically */
    .main-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 0;
      width: 100%;
    }

    /* Mosaic Grid - Edge to Edge, No Gaps */
    .mosaic {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(68px, 1fr));
      width: 100%;
    }

    .mosaic-tile {
      position: relative;
      aspect-ratio: 1;
      overflow: hidden;
      cursor: pointer;
    }

    .mosaic-tile img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }

    .mosaic-tile:hover img {
      transform: scale(1.05);
    }

    /* Black spacer tiles */
    .mosaic-tile.spacer {
      background: #111;
      cursor: default;
    }

    /* Word overlay on spacer runs */
    .word-overlay {
      position: absolute;
      pointer-events: none;
      font-size: 1.2rem;
      font-weight: 300;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 0.4em;
      text-transform: uppercase;
      white-space: nowrap;
      z-index: 10;
      opacity: 0;
      transition: opacity 1s ease;
    }

    .word-overlay.revealed {
      opacity: 1;
    }

    .mosaic-container {
      position: relative;
      width: 100%;
    }

    /* Reveal animation */
    .mosaic-tile {
      opacity: 0;
    }

    .mosaic-tile.revealed {
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    /* Fullscreen Overlay */
    .fullscreen-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .fullscreen-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .fullscreen-overlay img.main-img {
      display: none;
    }

    /* Puzzle tile grid */
    .puzzle-container {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
    }

    .puzzle-grid {
      display: grid;
      gap: 0;
    }

    .puzzle-tile {
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.3s ease, transform 0.3s ease;
      overflow: hidden;
    }

    .puzzle-tile.revealed {
      opacity: 1;
      transform: scale(1);
    }

    .puzzle-tile img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .close-btn {
      position: absolute;
      top: 30px;
      right: 30px;
      width: 50px;
      height: 50px;
      background: transparent;
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 50%;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-btn:hover {
      background: rgba(255,255,255,0.1);
      border-color: #fff;
    }

    /* Nav arrows */
    .nav-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 60px;
      height: 60px;
      background: transparent;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      color: #fff;
      font-size: 28px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-arrow:hover {
      background: rgba(255,255,255,0.1);
      border-color: #fff;
    }

    .nav-arrow.prev {
      left: 30px;
    }

    .nav-arrow.next {
      right: 30px;
    }

    /* Image counter */
    .image-counter {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      color: rgba(255,255,255,0.6);
      letter-spacing: 2px;
    }
  </style>
</head>
<body>

  <header class="site-header">
    <a href="index.html" class="site-logo">Max Kovalsky</a>
    <div class="nav-toggle" onclick="document.querySelector('.site-nav').classList.toggle('active')">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <nav class="site-nav">
      <div class="nav-dropdown">
        <a href="pages/studio.html">Island Art Studio</a>
        <div class="dropdown-menu">
          <a href="pages/workshops.html">Workshops</a>
          <a href="pages/lectures.html">Lectures</a>
        </div>
      </div>
      <a href="index.html" class="active">Portfolio</a>
      <a href="pages/about.html">About</a>
      <a href="pages/contact.html">Contact</a>
    </nav>
  </header>

  <main class="main-content">
    <div class="mosaic-container">
    <div class="mosaic" id="mosaic">
    <!-- SCAPES -->
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/A4755088-08E7-4B04-89EF-A4320ADCB3EA.jpg"><img src="home/portfolio/thumbs/scapes/A4755088-08E7-4B04-89EF-A4320ADCB3EA.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/Beli.jpg"><img src="home/portfolio/thumbs/scapes/Beli.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/Clinton_sail.jpg"><img src="home/portfolio/thumbs/scapes/Clinton_sail.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_2234_edited.jpg"><img src="home/portfolio/thumbs/scapes/IMG_2234_edited.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_2235.jpg"><img src="home/portfolio/thumbs/scapes/IMG_2235.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_2281.jpg"><img src="home/portfolio/thumbs/scapes/IMG_2281.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4818.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4818.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4833.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4833.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4837.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4837.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4845.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4845.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4871.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4871.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4892.jpg"><img src="home/portfolio/thumbs/scapes/IMG_4892.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_5031.jpg"><img src="home/portfolio/thumbs/scapes/IMG_5031.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_5032.jpg"><img src="home/portfolio/thumbs/scapes/IMG_5032.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_5033.jpg"><img src="home/portfolio/thumbs/scapes/IMG_5033.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_6192.jpg"><img src="home/portfolio/thumbs/scapes/IMG_6192.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/Taormina.jpg"><img src="home/portfolio/thumbs/scapes/Taormina.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/clinton.jpg"><img src="home/portfolio/thumbs/scapes/clinton.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/clinton_ct.jpg"><img src="home/portfolio/thumbs/scapes/clinton_ct.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/dfhxctr-030d7721-ec4b-46b1-915b-1f3cd5f41d07.jpg"><img src="home/portfolio/thumbs/scapes/dfhxctr-030d7721-ec4b-46b1-915b-1f3cd5f41d07.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/dfhxcyy-b57d967d-d1df-4607-b93b-ccc29535a7af.jpg"><img src="home/portfolio/thumbs/scapes/dfhxcyy-b57d967d-d1df-4607-b93b-ccc29535a7af.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/seascape1.jpg"><img src="home/portfolio/thumbs/scapes/seascape1.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/seascape2.jpg"><img src="home/portfolio/thumbs/scapes/seascape2.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/seascape3.jpg"><img src="home/portfolio/thumbs/scapes/seascape3.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/seascape4.jpg"><img src="home/portfolio/thumbs/scapes/seascape4.jpg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/7BCB76E0-7DA4-4674-AEF7-D4756C3F8945.JPG"><img src="home/portfolio/thumbs/scapes/7BCB76E0-7DA4-4674-AEF7-D4756C3F8945.JPG" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/BD411DB5-3661-4E4C-A591-37B0C6DD9C0F.JPG"><img src="home/portfolio/thumbs/scapes/BD411DB5-3661-4E4C-A591-37B0C6DD9C0F.JPG" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_1875.JPG"><img src="home/portfolio/thumbs/scapes/IMG_1875.JPG" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_1897.JPG"><img src="home/portfolio/thumbs/scapes/IMG_1897.JPG" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_0489.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_0489.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_4819.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_4819.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_6697.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_6697.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_6698.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_6698.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_6699.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_6699.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_6811.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_6811.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_7328.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_7328.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_7469.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_7469.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_7731.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_7731.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_8184.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_8184.jpeg" alt="Seascape"></div>
    <div class="mosaic-tile" data-section="scapes" data-full="home/portfolio/scapes/IMG_8477.jpeg"><img src="home/portfolio/thumbs/scapes/IMG_8477.jpeg" alt="Seascape"></div>
    <!-- PORTRAITS -->
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Brian.jpg"><img src="home/portfolio/thumbs/portraits/Brian.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/FF580177-68AD-4878-BBE4-BC3DBED438DA.jpg"><img src="home/portfolio/thumbs/portraits/FF580177-68AD-4878-BBE4-BC3DBED438DA.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/IMG_4676.jpg"><img src="home/portfolio/thumbs/portraits/IMG_4676.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/IMG_4681.jpg"><img src="home/portfolio/thumbs/portraits/IMG_4681.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/IMG_5065.jpg"><img src="home/portfolio/thumbs/portraits/IMG_5065.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Mike.jpg"><img src="home/portfolio/thumbs/portraits/Mike.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Natalya.jpg"><img src="home/portfolio/thumbs/portraits/Natalya.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Sam.jpg"><img src="home/portfolio/thumbs/portraits/Sam.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Sasha2.jpg"><img src="home/portfolio/thumbs/portraits/Sasha2.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Shasha1.jpg"><img src="home/portfolio/thumbs/portraits/Shasha1.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/The Bather_2.jpg"><img src="home/portfolio/thumbs/portraits/The Bather_2.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Vera.jpg"><img src="home/portfolio/thumbs/portraits/Vera.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Yuri1.jpg"><img src="home/portfolio/thumbs/portraits/Yuri1.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/Yuri2.jpg"><img src="home/portfolio/thumbs/portraits/Yuri2.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/de0za47-9d003069-0f99-4679-a587-222a38b663fd.jpg"><img src="home/portfolio/thumbs/portraits/de0za47-9d003069-0f99-4679-a587-222a38b663fd.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/de0za4o-080afdc9-6786-4a63-ba93-28edc3b06034_edited.jpg"><img src="home/portfolio/thumbs/portraits/de0za4o-080afdc9-6786-4a63-ba93-28edc3b06034_edited.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/de0za52-66024882-68d8-4118-a9fc-0227a14bc6f4.jpg"><img src="home/portfolio/thumbs/portraits/de0za52-66024882-68d8-4118-a9fc-0227a14bc6f4.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/df3jv9m-e4693d45-fcaf-4cff-9d14-92b68ab84ec0.jpg"><img src="home/portfolio/thumbs/portraits/df3jv9m-e4693d45-fcaf-4cff-9d14-92b68ab84ec0.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/hoff.jpg"><img src="home/portfolio/thumbs/portraits/hoff.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/mother_and_daughter_by_tintandshade_de0ux9c-fullview.jpg"><img src="home/portfolio/thumbs/portraits/mother_and_daughter_by_tintandshade_de0ux9c-fullview.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/stella.jpg"><img src="home/portfolio/thumbs/portraits/stella.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/untitled_by_tintandshade_de0uxv4-fullview.jpg"><img src="home/portfolio/thumbs/portraits/untitled_by_tintandshade_de0uxv4-fullview.jpg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/IMG_7841.jpeg"><img src="home/portfolio/thumbs/portraits/IMG_7841.jpeg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/portrait2.jpeg"><img src="home/portfolio/thumbs/portraits/portrait2.jpeg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/portrait3.jpeg"><img src="home/portfolio/thumbs/portraits/portrait3.jpeg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/portrait4.jpeg"><img src="home/portfolio/thumbs/portraits/portrait4.jpeg" alt="Portrait"></div>
    <div class="mosaic-tile" data-section="portraits" data-full="home/portfolio/portraits/IMG_7308.png"><img src="home/portfolio/thumbs/portraits/IMG_7308.png" alt="Portrait"></div>
    <!-- MASTER STUDIES -->
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_2004.jpg"><img src="home/portfolio/thumbs/master_studies/IMG_2004.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_4868.jpg"><img src="home/portfolio/thumbs/master_studies/IMG_4868.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/Onion_seller.jpg"><img src="home/portfolio/thumbs/master_studies/Onion_seller.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/after_Monet.jpg"><img src="home/portfolio/thumbs/master_studies/after_Monet.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/benson.jpg"><img src="home/portfolio/thumbs/master_studies/benson.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/bergman.jpg"><img src="home/portfolio/thumbs/master_studies/bergman.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/de0za1r-c5cfd451-5960-465d-8db3-f840caf1a943.jpg"><img src="home/portfolio/thumbs/master_studies/de0za1r-c5cfd451-5960-465d-8db3-f840caf1a943.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/de0za6g-f1ed0197-410b-41df-a170-22a4632a3735.jpg"><img src="home/portfolio/thumbs/master_studies/de0za6g-f1ed0197-410b-41df-a170-22a4632a3735.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/de0za83-826760c9-69ff-4481-badb-b4c3336e0d4f.jpg"><img src="home/portfolio/thumbs/master_studies/de0za83-826760c9-69ff-4481-badb-b4c3336e0d4f.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/de1323a-8cdce614-b75c-409a-b452-7491ee09b924.jpg"><img src="home/portfolio/thumbs/master_studies/de1323a-8cdce614-b75c-409a-b452-7491ee09b924.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/de1324q-c2155dd7-f732-4c60-89cf-a558b2b65023.jpg"><img src="home/portfolio/thumbs/master_studies/de1324q-c2155dd7-f732-4c60-89cf-a558b2b65023.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/rembrandt.jpg"><img src="home/portfolio/thumbs/master_studies/rembrandt.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/rubens.jpg"><img src="home/portfolio/thumbs/master_studies/rubens.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/sargent.jpg"><img src="home/portfolio/thumbs/master_studies/sargent.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/titian.jpg"><img src="home/portfolio/thumbs/master_studies/titian.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/vandyck.jpg"><img src="home/portfolio/thumbs/master_studies/vandyck.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/vermeer1.jpg"><img src="home/portfolio/thumbs/master_studies/vermeer1.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/vermeer2.jpg"><img src="home/portfolio/thumbs/master_studies/vermeer2.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/whistler.jpg"><img src="home/portfolio/thumbs/master_studies/whistler.jpg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_1971.JPG"><img src="home/portfolio/thumbs/master_studies/IMG_1971.JPG" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_2304.JPG"><img src="home/portfolio/thumbs/master_studies/IMG_2304.JPG" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_0269.jpeg"><img src="home/portfolio/thumbs/master_studies/IMG_0269.jpeg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_8182.jpeg"><img src="home/portfolio/thumbs/master_studies/IMG_8182.jpeg" alt="Master Study"></div>
    <div class="mosaic-tile" data-section="masters" data-full="home/portfolio/master_studies/IMG_8715.jpeg"><img src="home/portfolio/thumbs/master_studies/IMG_8715.jpeg" alt="Master Study"></div>
    </div>
    </div>
  </main>

  <!-- Fullscreen Viewer -->
  <div class="fullscreen-overlay" id="overlay">
    <button class="close-btn" onclick="closeOverlay()">&times;</button>
    <button class="nav-arrow prev" onclick="navigate(-1)">&larr;</button>
    <div class="puzzle-container">
      <div class="puzzle-grid" id="puzzle-grid"></div>
    </div>
    <button class="nav-arrow next" onclick="navigate(1)">&rarr;</button>
    <div class="image-counter"><span id="current-num">1</span> / <span id="total-num">16</span></div>
  </div>

  <script>
    const mosaic = document.getElementById('mosaic');
    const overlay = document.getElementById('overlay');
    const puzzleGrid = document.getElementById('puzzle-grid');
    const currentNum = document.getElementById('current-num');
    const totalNum = document.getElementById('total-num');

    // Section configuration
    const sections = [
      { name: 'scapes', word: 'SCAPES' },
      { name: 'portraits', word: 'PORTRAITS' },
      { name: 'masters', word: 'MASTERS' }
    ];

    // Get all image tiles (not spacers) and store original data
    let imageTiles = Array.from(document.querySelectorAll('.mosaic-tile:not(.spacer)'));
    let currentIndex = 0;

    // Get image path from the clicked tile directly (not from a static array)
    function getImagePath(tile) {
      return tile.dataset.full || tile.querySelector('img').src;
    }

    // Get current ordered list of image tiles (after any re-ordering)
    function getCurrentImageTiles() {
      return Array.from(mosaic.querySelectorAll('.mosaic-tile:not(.spacer)'));
    }

    // Create organic clustered black tiles with section-aware word overlays
    function createClusteredSpacers() {
      const mosaicWidth = mosaic.offsetWidth;
      const tileSize = 68;
      const cols = Math.floor(mosaicWidth / tileSize) || 12;
      const numImages = imageTiles.length;
      const targetSpacers = Math.floor(numImages * 0.75);
      const totalTiles = numImages + targetSpacers;
      const rows = Math.ceil(totalTiles / cols) + 2;
      const totalCells = rows * cols;

      // Create a 2D grid to track positions
      const grid = new Array(totalCells).fill(null);

      // Group images by section for placement
      const sectionTiles = {};
      sections.forEach(s => sectionTiles[s.name] = []);
      imageTiles.forEach(tile => {
        const section = tile.dataset.section;
        if (sectionTiles[section]) {
          sectionTiles[section].push(tile);
        }
      });

      // Calculate approximate row ranges for each section
      let currentRow = 0;
      const sectionRanges = {};
      sections.forEach(section => {
        const sectionImages = sectionTiles[section.name].length;
        const sectionSpacers = Math.floor(sectionImages * 0.75);
        const sectionTotalTiles = sectionImages + sectionSpacers;
        const sectionRows = Math.ceil(sectionTotalTiles / cols);
        sectionRanges[section.name] = {
          startRow: currentRow,
          endRow: currentRow + sectionRows,
          tiles: sectionTiles[section.name]
        };
        currentRow += sectionRows;
      });

      // Place images section by section, with some scatter within each section
      const allTilesToPlace = [];
      sections.forEach(section => {
        const range = sectionRanges[section.name];
        const tiles = range.tiles;
        const startCell = range.startRow * cols;
        const endCell = Math.min(range.endRow * cols, totalCells);

        tiles.forEach(tile => {
          let pos;
          let attempts = 0;
          do {
            pos = startCell + Math.floor(Math.random() * (endCell - startCell));
            attempts++;
          } while (grid[pos] !== null && attempts < 100);

          if (grid[pos] === null) {
            grid[pos] = { type: 'image', tile, section: section.name };
          } else {
            // Fallback: find any empty cell
            for (let i = 0; i < totalCells; i++) {
              if (grid[i] === null) {
                grid[i] = { type: 'image', tile, section: section.name };
                break;
              }
            }
          }
        });
      });

      // Generate cluster seeds for spacers
      const numSeeds = Math.floor(totalCells * 0.08);
      for (let i = 0; i < numSeeds; i++) {
        let pos;
        let attempts = 0;
        do {
          pos = Math.floor(Math.random() * totalCells);
          attempts++;
        } while (grid[pos] !== null && attempts < 50);
        if (grid[pos] === null) {
          grid[pos] = { type: 'spacer' };
        }
      }

      // Grow clusters organically
      function getNeighbors(pos) {
        const row = Math.floor(pos / cols);
        const col = pos % cols;
        const neighbors = [];
        const directions = [
          [-1, -1], [-1, 0], [-1, 1],
          [0, -1],           [0, 1],
          [1, -1],  [1, 0],  [1, 1]
        ];
        for (const [dr, dc] of directions) {
          const nr = row + dr;
          const nc = col + dc;
          if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) {
            neighbors.push(nr * cols + nc);
          }
        }
        return neighbors;
      }

      let spacerCount = grid.filter(c => c && c.type === 'spacer').length;
      let iterations = 0;
      while (spacerCount < targetSpacers && iterations < 1000) {
        const spacerPositions = [];
        grid.forEach((cell, i) => {
          if (cell && cell.type === 'spacer') spacerPositions.push(i);
        });

        if (spacerPositions.length === 0) break;

        const sourcePos = spacerPositions[Math.floor(Math.random() * spacerPositions.length)];
        const neighbors = getNeighbors(sourcePos);

        for (let i = neighbors.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [neighbors[i], neighbors[j]] = [neighbors[j], neighbors[i]];
        }

        for (const neighborPos of neighbors) {
          if (grid[neighborPos] === null && Math.random() < 0.7) {
            grid[neighborPos] = { type: 'spacer' };
            spacerCount++;
            break;
          }
        }
        iterations++;
      }

      // Build the final mosaic
      mosaic.innerHTML = '';
      const elements = [];

      grid.forEach((cell, i) => {
        if (cell && cell.type === 'image') {
          elements.push({ pos: i, el: cell.tile, section: cell.section });
        } else if (cell && cell.type === 'spacer') {
          const spacer = document.createElement('div');
          spacer.className = 'mosaic-tile spacer';
          elements.push({ pos: i, el: spacer, section: null });
        }
      });

      // Sort by position and append
      elements.sort((a, b) => a.pos - b.pos);
      elements.forEach(item => mosaic.appendChild(item.el));

      // Store section boundaries for word overlay placement
      window.sectionElements = elements;
    }

    createClusteredSpacers();

    // Find horizontal runs of 3+ spacers and place word overlays for each section
    function addWordOverlays() {
      const container = document.querySelector('.mosaic-container');
      const allTiles = Array.from(mosaic.children);
      const cols = Math.round(mosaic.offsetWidth / 68) || 12;
      const tileSize = mosaic.children[0]?.offsetWidth || 68;

      // Find row ranges for each section based on image positions
      const sectionRowRanges = {};
      sections.forEach(s => {
        sectionRowRanges[s.name] = { minRow: Infinity, maxRow: -1 };
      });

      allTiles.forEach((tile, index) => {
        const row = Math.floor(index / cols);
        const section = tile.dataset?.section;
        if (section && sectionRowRanges[section]) {
          sectionRowRanges[section].minRow = Math.min(sectionRowRanges[section].minRow, row);
          sectionRowRanges[section].maxRow = Math.max(sectionRowRanges[section].maxRow, row);
        }
      });

      // Find all horizontal runs of 3+ spacers
      const runs = [];
      let currentRun = [];

      allTiles.forEach((tile, index) => {
        const col = index % cols;
        const row = Math.floor(index / cols);

        if (tile.classList.contains('spacer')) {
          if (col === 0 && currentRun.length > 0) {
            if (currentRun.length >= 3) runs.push([...currentRun]);
            currentRun = [];
          }
          currentRun.push({ tile, index, col, row });
        } else {
          if (currentRun.length >= 3) runs.push([...currentRun]);
          currentRun = [];
        }
      });
      if (currentRun.length >= 3) runs.push([...currentRun]);

      // Calculate strict non-overlapping row boundaries for each section
      // Use the midpoint between adjacent sections as the boundary
      const strictRanges = {};
      const sectionOrder = ['scapes', 'portraits', 'masters'];

      sectionOrder.forEach((name, idx) => {
        const range = sectionRowRanges[name];
        if (range.minRow === Infinity) return;

        let effectiveMin = range.minRow;
        let effectiveMax = range.maxRow;

        // If there's a previous section, set boundary at midpoint
        if (idx > 0) {
          const prevName = sectionOrder[idx - 1];
          const prevRange = sectionRowRanges[prevName];
          if (prevRange && prevRange.maxRow !== -1) {
            const boundary = Math.floor((prevRange.maxRow + range.minRow) / 2);
            effectiveMin = boundary + 1;
          }
        }

        // If there's a next section, set boundary at midpoint
        if (idx < sectionOrder.length - 1) {
          const nextName = sectionOrder[idx + 1];
          const nextRange = sectionRowRanges[nextName];
          if (nextRange && nextRange.minRow !== Infinity) {
            const boundary = Math.floor((range.maxRow + nextRange.minRow) / 2);
            effectiveMax = boundary;
          }
        }

        strictRanges[name] = { minRow: effectiveMin, maxRow: effectiveMax };
      });

      // Track used runs to prevent reuse
      const usedRuns = new Set();

      // For each section, find the best run within its strict row range
      sections.forEach(section => {
        const range = strictRanges[section.name];
        if (!range) return;

        // Filter runs that fall strictly within this section's range
        const sectionRuns = runs.filter((run, runIdx) => {
          if (usedRuns.has(runIdx)) return false;
          const runRow = run[0].row;
          return runRow >= range.minRow && runRow <= range.maxRow;
        });

        if (sectionRuns.length === 0) return;

        // Sort by length and pick the longest
        sectionRuns.sort((a, b) => b.length - a.length);
        const run = sectionRuns[0];

        // Mark this run as used
        const runIdx = runs.indexOf(run);
        usedRuns.add(runIdx);

        // Get position of first tile in run
        const firstTile = run[0].tile;
        const rect = firstTile.getBoundingClientRect();
        const containerRect = container.getBoundingClientRect();

        const runWidth = run.length * tileSize;
        const top = rect.top - containerRect.top + (tileSize / 2) - 10;
        const left = rect.left - containerRect.left;

        const wordOverlay = document.createElement('div');
        wordOverlay.className = 'word-overlay';
        wordOverlay.textContent = section.word;
        wordOverlay.style.top = top + 'px';
        wordOverlay.style.left = left + 'px';
        wordOverlay.style.width = runWidth + 'px';
        wordOverlay.style.textAlign = 'center';
        container.appendChild(wordOverlay);

        // Reveal after tiles animation completes
        setTimeout(() => {
          wordOverlay.classList.add('revealed');
        }, 2500 + sections.indexOf(section) * 500);
      });
    }

    // Delay word overlays until after layout settles
    setTimeout(addWordOverlays, 100);

    // Get all tiles for reveal animation
    const allTilesAfter = Array.from(mosaic.querySelectorAll('.mosaic-tile'));

    // Shuffle array for random reveal order
    function shuffle(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // Reveal tiles in random order with staggered timing
    const shuffledTiles = shuffle(allTilesAfter);
    shuffledTiles.forEach((tile, index) => {
      setTimeout(() => {
        tile.classList.add('revealed');
      }, index * 30); // 30ms stagger between each tile
    });

    totalNum.textContent = imageTiles.length;

    // Re-query image tiles after rebuild and attach click handlers
    const finalImageTiles = Array.from(mosaic.querySelectorAll('.mosaic-tile:not(.spacer)'));
    finalImageTiles.forEach((tile, index) => {
      tile.addEventListener('click', () => {
        currentIndex = index;
        openOverlay();
      });
    });

    const TILE_SIZE = 68; // Match mosaic tile size
    const GRID_COLS = 10;
    const GRID_ROWS = 8;

    function createPuzzleTiles(imgSrc) {
      // Clear previous tiles
      puzzleGrid.innerHTML = '';

      // Load image to get dimensions
      const img = new Image();
      img.src = imgSrc;

      img.onload = () => {
        // Calculate display size (max 90vw x 90vh)
        const maxW = window.innerWidth * 0.9;
        const maxH = window.innerHeight * 0.9;
        const scale = Math.min(maxW / img.width, maxH / img.height);
        const displayW = img.width * scale;
        const displayH = img.height * scale;

        // Calculate tile dimensions - use floor to avoid subpixel issues
        const tileW = Math.floor(displayW / GRID_COLS);
        const tileH = Math.floor(displayH / GRID_ROWS);

        // Recalculate total size based on floored tile dimensions
        const gridW = tileW * GRID_COLS;
        const gridH = tileH * GRID_ROWS;

        // Set grid size with explicit pixel dimensions
        puzzleGrid.style.width = gridW + 'px';
        puzzleGrid.style.height = gridH + 'px';
        puzzleGrid.style.gridTemplateColumns = `repeat(${GRID_COLS}, ${tileW}px)`;
        puzzleGrid.style.gridTemplateRows = `repeat(${GRID_ROWS}, ${tileH}px)`;

        // Create tiles
        const tiles = [];
        for (let row = 0; row < GRID_ROWS; row++) {
          for (let col = 0; col < GRID_COLS; col++) {
            const tile = document.createElement('div');
            tile.className = 'puzzle-tile';

            // Each tile shows a portion of the image using background-position
            // Use the grid dimensions for background-size to match exactly
            tile.style.backgroundImage = `url(${imgSrc})`;
            tile.style.backgroundSize = `${gridW}px ${gridH}px`;
            tile.style.backgroundPosition = `-${col * tileW}px -${row * tileH}px`;

            puzzleGrid.appendChild(tile);
            tiles.push(tile);
          }
        }

        // Shuffle tiles for random reveal order
        const shuffledTiles = [...tiles];
        for (let i = shuffledTiles.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffledTiles[i], shuffledTiles[j]] = [shuffledTiles[j], shuffledTiles[i]];
        }

        // Reveal tiles one by one
        shuffledTiles.forEach((tile, index) => {
          setTimeout(() => {
            tile.classList.add('revealed');
          }, index * 15); // 15ms between each tile
        });
      };
    }

    function openOverlay() {
      const currentTiles = getCurrentImageTiles();
      currentNum.textContent = currentIndex + 1;
      totalNum.textContent = currentTiles.length;
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';

      // Start puzzle animation with the correct image from the current tile
      const currentTile = currentTiles[currentIndex];
      const imgPath = getImagePath(currentTile);
      createPuzzleTiles(imgPath);
    }

    function closeOverlay() {
      // Disassemble puzzle tiles in random order
      const tiles = Array.from(puzzleGrid.querySelectorAll('.puzzle-tile'));

      // Shuffle for random disassembly
      for (let i = tiles.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [tiles[i], tiles[j]] = [tiles[j], tiles[i]];
      }

      // Remove revealed class quickly
      tiles.forEach((tile, index) => {
        setTimeout(() => {
          tile.classList.remove('revealed');
        }, index * 5);
      });

      // After disassembly completes, close overlay and re-randomize mosaic
      const disassemblyTime = tiles.length * 5 + 200;
      setTimeout(() => {
        overlay.classList.remove('active');
        document.body.style.overflow = '';
        puzzleGrid.innerHTML = '';

        // Re-randomize the mosaic
        reRandomizeMosaic();
      }, disassemblyTime);
    }

    function reRandomizeMosaic() {
      // Get current image tiles grouped by section
      const allTiles = Array.from(mosaic.querySelectorAll('.mosaic-tile'));
      const imgTiles = allTiles.filter(t => !t.classList.contains('spacer'));

      // Reset imageTiles for createClusteredSpacers
      imageTiles = imgTiles;

      // Remove revealed class from all
      imgTiles.forEach(tile => tile.classList.remove('revealed'));

      // Rebuild with clustering algorithm
      createClusteredSpacers();

      // Re-attach click handlers to image tiles
      const newImageTiles = Array.from(mosaic.querySelectorAll('.mosaic-tile:not(.spacer)'));
      newImageTiles.forEach((tile, index) => {
        tile.addEventListener('click', () => {
          currentIndex = index;
          openOverlay();
        });
      });

      // Reveal tiles with animation
      const allNewTiles = Array.from(mosaic.querySelectorAll('.mosaic-tile'));
      const shuffledReveal = [...allNewTiles];
      for (let i = shuffledReveal.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledReveal[i], shuffledReveal[j]] = [shuffledReveal[j], shuffledReveal[i]];
      }

      shuffledReveal.forEach((tile, index) => {
        setTimeout(() => {
          tile.classList.add('revealed');
        }, index * 8);
      });

      // Update word overlays
      document.querySelectorAll('.word-overlay').forEach(el => el.remove());
      setTimeout(addWordOverlays, 100);
    }

    function navigate(direction) {
      const currentTiles = getCurrentImageTiles();
      currentIndex += direction;
      if (currentIndex < 0) currentIndex = currentTiles.length - 1;
      if (currentIndex >= currentTiles.length) currentIndex = 0;
      currentNum.textContent = currentIndex + 1;

      // Reset and rebuild puzzle with the correct image
      puzzleGrid.innerHTML = '';
      const currentTile = currentTiles[currentIndex];
      const imgPath = getImagePath(currentTile);
      createPuzzleTiles(imgPath);
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (!overlay.classList.contains('active')) return;
      if (e.key === 'Escape') closeOverlay();
      if (e.key === 'ArrowLeft') navigate(-1);
      if (e.key === 'ArrowRight') navigate(1);
    });

    // Click outside image or on puzzle to close
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay || e.target.closest('.puzzle-grid')) closeOverlay();
    });
  </script>
</body>
</html>
